local point1 = hs.geometry.point(1525, 18)
local point2 = hs.geometry.point(1573, 185)
local point3 = hs.geometry.point(818, 614)
local newDesktop = hs.geometry.point(37, 94)

hs.hotkey.bind({"alt", "shift"}, "R", function()
    local currentPoint = hs.mouse.getAbsolutePosition()

    hs.eventtap.leftClick(point3)
    hs.timer.usleep(100000)
    hs.eventtap.leftClick(point1)
    hs.timer.usleep(10000)
    hs.eventtap.leftClick(point2)
    hs.timer.usleep(1000)
    hs.eventtap.leftClick(currentPoint)

end)

hs.hotkey.bind({"cmd", "alt", "ctrl"}, "M", function()
    hs.eventtap.keyStroke({"cmd", "alt"}, "H")
    hs.timer.usleep(1000)
    hs.eventtap.keyStroke({"cmd", "alt"}, "M")
end)

hs.hotkey.bind({"cmd", "alt", "ctrl", "shift"}, "P", function()
    local point = hs.mouse.getAbsolutePosition()
    hs.alert.show("Mouse at: " .. hs.inspect(point))
end)

hs.hotkey.bind({"alt", "shift"}, "D", function()
    hs.spaces.addSpaceToScreen()
    local screen = hs.screen.mainScreen()
    local screenUUID = screen:getUUID()
    local screenIDs = hs.spaces.allSpaces()[screenUUID]    
    hs.spaces.gotoSpace(screenIDs[#screenIDs])
end)


hs.hotkey.bind({"alt", "shift"}, "X", function()
    local activeID = hs.spaces.focusedSpace()
    local screen = hs.screen.mainScreen()
    local screenUUID = screen:getUUID()
    local screenIDs = hs.spaces.allSpaces()[screenUUID]

    if #screenIDs < 2 then
        return
    end
    
    hs.spaces.gotoSpace(screenIDs[1])
    
    hs.timer.usleep(300000)
    
    local center = hs.geometry.rectMidPoint(screen:frame())
    hs.mouse.setAbsolutePosition(center)
    local newSpace = hs.spaces.focusedSpace()
    
    if newSpace ~= activeID then
        hs.spaces.removeSpace(activeID)
        screenIDs = hs.spaces.allSpaces()[screenUUID]
        hs.spaces.gotoSpace(screenIDs[#screenIDs])
    else
        hs.alert("Failed to switch spaces - cannot remove")
    end
end)

hs.hotkey.bind({"alt", "cmd", "ctrl"}, "up", function()
    local slackBundleID = "com.tinyspeck.slackmacgap"
    local warpBundleID = "dev.warp.Warp-Stable"
    local cursorApp = "Cursor.app"
    local arcBundleID = "company.thebrowser.Browser"

    hs.application.launchOrFocusByBundleID(slackBundleID)
    hs.application.launchOrFocusByBundleID(warpBundleID)

    hs.application.launchOrFocus(cursorApp)

    hs.timer.doAfter(2, function()
        hs.application.launchOrFocusByBundleID(arcBundleID)
    end)
end)

hs.hotkey.bind({"cmd", "alt", "ctrl", "shift"}, "H", function()
    hs.execute("open ~/.hammerspoon/init.lua")
end)

hs.hotkey.bind({"cmd", "alt", "ctrl"}, "A", function()
    -- 1. Create 3 new Arc windows via AppleScript
    local script = [[
        tell application "Arc"
            repeat 3 times
                make new window
            end repeat
            activate
        end tell
    ]]
    hs.osascript.applescript(script)

    -- 2. Give Arc a moment to spawn windows
    hs.timer.doAfter(1.5, function()
        local app = hs.appfinder.appFromName("Arc")
        if not app then return end

        local windows = app:allWindows()
        local screens = hs.screen.allScreens()

        -- 3. Sort windows by creation time (rough order)
        table.sort(windows, function(a, b)
            return a:id() < b:id()
        end)

        -- 4. Move each window to a different screen
        for i, win in ipairs(windows) do
            local targetScreen = screens[((i - 1) % #screens) + 1]
            if win:isStandard() then
                win:moveToScreen(targetScreen)
                win:centerOnScreen(targetScreen)
            end
        end
    end)
end)

local mouseCircleRed = nil
local mouseCircleYellow = nil
local mouseCircleTimer = nil

local function drawMouseCircle()
    -- Cleanup existing
    if mouseCircleRed then mouseCircleRed:delete() end
    if mouseCircleYellow then mouseCircleYellow:delete() end
    mouseCircleRed = nil
    mouseCircleYellow = nil

    local mousePos = hs.mouse.absolutePosition()
    local radius = 60

    -- Outer YELLOW circle
    mouseCircleYellow = hs.drawing.circle(
        hs.geometry.rect(
            mousePos.x - radius - 10,
            mousePos.y - radius - 10,
            (radius + 10) * 2,
            (radius + 10) * 2
        )
    )
    mouseCircleYellow:setStrokeColor({ red = 1, green = 1, blue = 0, alpha = 1 })
    mouseCircleYellow:setFill(false)
    mouseCircleYellow:setStrokeWidth(30)
    mouseCircleYellow:show()

    -- Inner RED circle
    mouseCircleRed = hs.drawing.circle(
        hs.geometry.rect(
            mousePos.x - radius,
            mousePos.y - radius,
            radius * 2,
            radius * 2
        )
    )
    mouseCircleRed:setStrokeColor({ red = 1, green = 0, blue = 0, alpha = 1 })
    mouseCircleRed:setFill(false)
    mouseCircleRed:setStrokeWidth(30)
    mouseCircleRed:show()

    -- Auto-remove
    mouseCircleTimer = hs.timer.doAfter(0.6, function()
        if mouseCircleRed then mouseCircleRed:delete() end
        if mouseCircleYellow then mouseCircleYellow:delete() end
        mouseCircleRed = nil
        mouseCircleYellow = nil
    end)
end

hs.hotkey.bind({ "ctrl" }, "F6", drawMouseCircle)

